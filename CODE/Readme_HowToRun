The .m files in this directory are the minimum you require. For a
better understanding of this code, please refer to the JGR paper
(initial submission : early 2025, first revision submitted July 2025)

This spectral trend climate analysis code assumes you have 

%%%%%%%%%%%%%%%%%%%%%%%%%

A : Spectral trends and uncertainties
(a) tiled AIRS radiance trends and uncertainties and lag1 corrections
    4608 tiles x 2645 AIRS L1C channels for each of the above
(b) you can also generate spectral trends from eg ERA5, MERRA2, AIRS v7 L3, CLIMCAPS L3 monthly data
    matched to the tiles

%%%%%%%%%%%%%%%%%%%%%%%%%

B : Accurate Jacobians
(a) jacobians need to be available (for T/WV/O3/surf temp/trace gas) for each tile
    T(z), WV(z), O3(z) jacobians are 100 layers x 2645 channels for AIRS L1C, for each tile
    SKT jacs are 1 x 2645 for each tile
    Trace Gas Column jacs (Co2,N2O,CH4,CFC11,CFC12) are also 1 x 2645 for each tile

%%%%%%%%%%%%%%%%%%%%%%%%%

C : Running the code
    Code is designed to run on the UMBC HPC cluster
    One tile can be run using the main driver code
      clust_run_retrieval_setlatbin_AIRS_loop_lonbin.m
    The code tkaes any one of the 64 latitude bins, and loops over the 72 longitude bins
    Inside that code, there are many default setting you can adjust using "topts," such as
      day or night
      number of channels
      which quantile you are using (Q01-Q05)
      do you wish to stick to AIRS 100 layers, or combine/sum jacobians for eg 50 layers or 33 layers
      tweak the covariance matrices (Tikhonov or exponential decay, diagonal etc)

    This is fast, less than 30 seconds per tile, or about 30 mins per 72 lonbins (one complete latitude bin).

%%%%%%%%%%%%%%%%%%%%%%%%%

D : output files go to Output or Output_Day 
   (depending on whether you chose day trends or night trends to be analyzed)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

We are not providing eg AIRS L1C tiled quantile trends since those are huge .mat files and can be generated
by downloading the L1C data and tiling it by 16 day intervals. 

Please contact Sergio DeSouza-Machado (sergio@umbc.edu) if you have questions
